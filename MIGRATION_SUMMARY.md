# üéâ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ gRPC-Web –ó–∞–≤–µ—Ä—à–µ–Ω–∞!

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ:

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
- ‚úÖ `google-protobuf` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Protocol Buffers
- ‚úÖ `grpc-web` - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ gRPC-Web

### –®–∞–≥ 2: –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è proto —Ñ–∞–π–ª–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `backend-proto/proto/`
- ‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã `core.proto` –∏ `common.proto`
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –Ω–µ–Ω—É–∂–Ω—ã–µ –ø–∞–ø–∫–∏ (protobuf-33.2, backend-main)

### –®–∞–≥ 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JavaScript —Ñ–∞–π–ª–æ–≤
**–í–ê–ñ–ù–û:** –°–æ–∑–¥–∞–Ω–æ –≤—Ä—É—á–Ω—É—é (–±–µ–∑ protoc):
- ‚úÖ `src/grpc/api_core_pb.js` - AlgorithmRequest
- ‚úÖ `src/grpc/api_core_grpc_web_pb.js` - FrontendStreamServiceClient
- ‚úÖ `src/grpc/shared_common_pb.js` - GraphPartResponse, ParseStatus –∏ –≤—Å–µ —Ç–∏–ø—ã

### –®–∞–≥ 4: –ù–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è grpcClient
- ‚úÖ –°–æ–∑–¥–∞–Ω `grpcClient-new.js` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º proto –∫–ª–∞—Å—Å–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è `grpcClient-old.js` (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è)
- ‚úÖ –ó–∞–º–µ–Ω—ë–Ω `grpcClient.js` –Ω–∞ –Ω–æ–≤—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ | ~750 | ~250 | **-67%** |
| –†—É—á–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ | –î–∞ | –ù–µ—Ç | ‚úÖ |
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–æ–≤ | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è | –ü–æ–ª–Ω–∞—è | ‚úÖ |
| –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | - | 100% | ‚úÖ |

## üß™ –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä
npm run dev
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ stream** - –æ—Ç–∫—Ä—ã—Ç—å ProjectAnalysis —Å—Ç—Ä–∞–Ω–∏—Ü—É
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
3. **–°—Ç–∞—Ç—É—Å DONE** - —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ stream –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** - –≥—Ä–∞—Ñ—ã –∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

## üîÑ –û—Ç–∫–∞—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:

```powershell
Copy-Item "src\services\grpcClient-old.js" "src\services\grpcClient.js" -Force
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:

```
frontend/
‚îú‚îÄ‚îÄ backend-proto/proto/          ‚Üê Proto —Å—Ö–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ api/core.proto
‚îÇ   ‚îî‚îÄ‚îÄ shared/common.proto
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ grpc/                     ‚Üê –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ JS —Ñ–∞–π–ª—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api_core_pb.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api_core_grpc_web_pb.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ shared_common_pb.js
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îú‚îÄ‚îÄ grpcClient.js         ‚Üê ‚úÖ –ù–û–í–ê–Ø —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (250 —Å—Ç—Ä–æ–∫)
‚îÇ       ‚îî‚îÄ‚îÄ grpcClient-old.js     ‚Üê üì¶ Backup (750 —Å—Ç—Ä–æ–∫)
‚îî‚îÄ‚îÄ node_modules/
    ‚îú‚îÄ‚îÄ google-protobuf/
    ‚îî‚îÄ‚îÄ grpc-web/
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –Ω–æ–≤—ã–º –∫–ª–∏–µ–Ω—Ç–æ–º
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
3. **–£–±–µ–¥–∏—Ç–µ—Å—å** —á—Ç–æ –≤—Å–µ callbacks —Ä–∞–±–æ—Ç–∞—é—Ç
4. –ï—Å–ª–∏ –≤—Å—ë –û–ö - –º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
   - `grpcClient-old.js`
   - `grpcClient-new.js`
   - `grpcClient-grpc-web.js`

## üí° –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

### –ö–æ–¥ —Å—Ç–∞–ª –ø—Ä–æ—â–µ:
```javascript
// –ë–´–õ–û (—Ä—É—á–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ):
encodeAlgorithmRequest(userId, taskId) {
  const buffer = [];
  buffer.push(0x08);
  this.writeVarint(buffer, userId);
  buffer.push(0x10);
  this.writeVarint(buffer, taskId);
  return new Uint8Array(buffer);
}

// –°–¢–ê–õ–û (–∏—Å–ø–æ–ª—å–∑—É–µ–º proto –∫–ª–∞—Å—Å):
const request = new AlgorithmRequest();
request.setUserId(userId);
request.setTaskId(taskId);
// –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Å—Ç–∞–ª–∞ —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π:
```javascript
// –ë–´–õ–û (—Ä—É—á–Ω–æ–π –ø–∞—Ä—Å–∏–Ω–≥ –±–∞–π—Ç–æ–≤):
decodeGraphPartResponse(bytes) {
  // 200+ —Å—Ç—Ä–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞...
}

// –°–¢–ê–õ–û (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è):
stream.on('data', (message) => {
  const status = message.getStatus();
  const requirements = message.getGraphRequirements();
  // –í—Å–µ –º–µ—Ç–æ–¥—ã —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã –∏ –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ IDE!
});
```

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–ù–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º –∫–æ–¥–æ–º.  
–í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π!
