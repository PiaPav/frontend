# ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –ù–∏—á–µ–≥–æ –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –æ—Ç gRPC

## üîç –ß—Ç–æ —è –æ–±–Ω–∞—Ä—É–∂–∏–ª

–Ø –ø—Ä–æ–≤–µ—Ä–∏–ª –≤—Å–µ —É—Ä–æ–≤–Ω–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

```bash
‚úÖ REST API (8000) - —Ä–∞–±–æ—Ç–∞–µ—Ç
‚ùå Envoy Proxy (8080) - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 503 Service Unavailable
```

## üéØ –í –ß–Å–ú –î–ï–õ–û

**Envoy Proxy –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Core gRPC Service.**

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:
- Envoy –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–æ—Ä—Ç 8080)
- –ù–æ Envoy –ù–ï –í–ò–î–ò–¢ Core service (–ø–æ—Ä—Ç 50051)
- –ü–æ—ç—Ç–æ–º—É –≤—Å–µ gRPC –∑–∞–ø—Ä–æ—Å—ã —Å frontend –ø–æ–ª—É—á–∞—é—Ç –æ—à–∏–±–∫—É 503

**Frontend –∫–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π**, –Ω–æ backend –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

## üìã –ß–¢–û –î–ï–õ–ê–¢–¨ –î–ê–õ–¨–®–ï

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ (—á–µ—Ä–µ–∑ –Ω–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç)

–Ø —Å–æ–∑–¥–∞–ª **–ø–æ–ª–Ω—ã–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç**: `diagnose-grpc.js`

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å frontend
npm run dev

# 2. –û—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä
open http://localhost:5173

# 3. –û—Ç–∫—Ä—ã—Ç—å DevTools (F12) ‚Üí Console

# 4. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ diagnose-grpc.js
#    –∏ –≤—Å—Ç–∞–≤–∏—Ç—å –≤ Console

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
diagnoseGrpc(userId, projectId)

# –ü—Ä–∏–º–µ—Ä:
diagnoseGrpc(9, 242)
```

**–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç:**
- ‚úÖ/‚ùå REST API –¥–æ—Å—Ç—É–ø–µ–Ω?
- ‚úÖ/‚ùå Envoy Proxy –¥–æ—Å—Ç—É–ø–µ–Ω?
- ‚úÖ/‚ùå gRPC endpoint –¥–æ—Å—Ç—É–ø–µ–Ω?
- ‚úÖ/‚ùå Stream —Ä–∞–±–æ—Ç–∞–µ—Ç?

–ò –¥–∞—Å—Ç **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏** —á—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –∫–∞–∂–¥–æ–π –æ—à–∏–±–∫–µ.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–µ—Ä–µ–¥–∞—Ç—å backend –∫–æ–º–∞–Ω–¥–µ

–Ø —Å–æ–∑–¥–∞–ª **–ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –¥–ª—è backend**: `BACKEND_FIX_REQUIRED.md`

**–û—Ç–ø—Ä–∞–≤—å—Ç–µ –∏–º —ç—Ç–æ—Ç —Ñ–∞–π–ª** - —Ç–∞–º:
- ‚úÖ –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã
- ‚úÖ 6 —à–∞–≥–æ–≤ –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–µ (docker ps, logs, network, config)
- ‚úÖ –¢–∏–ø–∏—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è (3 —Å—Ü–µ–Ω–∞—Ä–∏—è)
- ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±

–ï—Å–ª–∏ backend –Ω–µ –º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, –º–æ–∂–Ω–æ:

**A. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å mock –¥–∞–Ω–Ω—ã–µ** (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ UI)
```javascript
// –í—Ä–µ–º–µ–Ω–Ω–æ –≤ grpcClient.js
if (import.meta.env.DEV) {
  // –í–µ—Ä–Ω—É—Ç—å mock –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
}
```

**B. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ REST API** (–µ—Å–ª–∏ backend –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)
```javascript
// –í–º–µ—Å—Ç–æ gRPC stream –¥–µ–ª–∞—Ç—å polling
setInterval(() => {
  fetch(`/v1/projects/${projectId}/status`)
}, 5000)
```

## üß™ –§–∞–π–ª—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–Ø —Å–æ–∑–¥–∞–ª 2 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–∞:

1. **`diagnose-grpc.js`** ‚≠ê
   - –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –í–°–ï –ø—Ä–æ–±–ª–µ–º—ã –ø–æ—à–∞–≥–æ–≤–æ
   - –î–∞—ë—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

2. **`BACKEND_FIX_REQUIRED.md`** ‚≠ê
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è backend –∫–æ–º–∞–Ω–¥—ã
   - –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å Envoy ‚Üí Core —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
   - 6 —à–∞–≥–æ–≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ + —Ä–µ—à–µ–Ω–∏—è

## üìä –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, —á—Ç–æ –Ω–µ—Ç

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|--------|-------------|
| **Frontend –∫–æ–¥** | ‚úÖ | –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π, –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ |
| **REST API** | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç (8000) |
| **Envoy Proxy** | ‚ö†Ô∏è | –ó–∞–ø—É—â–µ–Ω, –Ω–æ –Ω–µ –≤–∏–¥–∏—Ç Core |
| **Core gRPC Service** | ‚ùå | –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è Envoy |
| **gRPC Stream** | ‚ùå | –ù–µ–≤–æ–∑–º–æ–∂–µ–Ω –ø–æ–∫–∞ Core –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω |

## üéØ –ò–¢–û–ì–û

### –ß—Ç–æ —Ç–æ—á–Ω–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:
```
Frontend ‚Üí Vite proxy ‚Üí Envoy (8080) ‚Üí ‚ùå Core (50051)
                                           ‚Üë
                                    –ó–¥–µ—Å—å –ø—Ä–æ–±–ª–µ–º–∞
```

### –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:

**–í–ê–†–ò–ê–ù–¢ 1 (–±—ã—Å—Ç—Ä—ã–π):** –ó–∞–ø—É—Å—Ç–∏—Ç—å `diagnose-grpc.js` –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç

**–í–ê–†–ò–ê–ù–¢ 2 (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π):** –û—Ç–ø—Ä–∞–≤–∏—Ç—å backend –∫–æ–º–∞–Ω–¥–µ `BACKEND_FIX_REQUIRED.md` –∏ –ø–æ–ø—Ä–æ—Å–∏—Ç—å –∏—Å–ø—Ä–∞–≤–∏—Ç—å Envoy/Core —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

**–í–ê–†–ò–ê–ù–¢ 3 (–≤—Ä–µ–º–µ–Ω–Ω—ã–π):** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å mock –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ UI –ø–æ–∫–∞ backend –Ω–µ –ø–æ—á–∏–Ω—è—Ç

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –°–µ–π—á–∞—Å (–ø—Ä—è–º–æ —Å–µ–π—á–∞—Å):

```bash
npm run dev
# –û—Ç–∫—Ä—ã—Ç—å http://localhost:5173
# F12 ‚Üí Console
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å diagnose-grpc.js ‚Üí –≤—Å—Ç–∞–≤–∏—Ç—å –≤ Console
# diagnoseGrpc(9, 242)
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç **—Ç–æ—á–Ω—É—é** –ø—Ä–æ–±–ª–µ–º—É —Å –¥–µ—Ç–∞–ª—è–º–∏.

### –ü–æ—Ç–æ–º:

–û—Ç–ø—Ä–∞–≤–∏—Ç—å backend –∫–æ–º–∞–Ω–¥–µ `BACKEND_FIX_REQUIRED.md` –∏ –ø–æ–ø—Ä–æ—Å–∏—Ç—å –∏—Å–ø—Ä–∞–≤–∏—Ç—å.

---

**–î–∞—Ç–∞:** 6 –¥–µ–∫–∞–±—Ä—è 2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** Envoy Proxy (8080) –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Core Service (50051)  
**–†–µ—à–µ–Ω–∏–µ:** Backend –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–µ—Ä–∏—Ç—å Docker network, Envoy config, Core service status  
**Frontend –∫–æ–¥:** ‚úÖ –ì–æ—Ç–æ–≤, –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ –Ω—ë–º
