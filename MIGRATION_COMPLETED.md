# โ ะะธะณัะฐัะธั ะฝะฐ gRPC-Web ะะะะะะจะะะ

## ะงัะพ ะฑัะปะพ ัะดะตะปะฐะฝะพ:

### 1. โ ะฃััะฐะฝะพะฒะปะตะฝั npm ะฟะฐะบะตัั
```bash
npm install google-protobuf grpc-web
```

### 2. โ ะัะณะฐะฝะธะทะพะฒะฐะฝะฐ ััััะบัััะฐ proto ัะฐะนะปะพะฒ
```
backend-proto/
โโโ proto/
    โโโ api/
    โ   โโโ core.proto
    โโโ shared/
        โโโ common.proto
```

### 3. โ ะกะพะทะดะฐะฝั JavaScript ัะฐะนะปั ะธะท proto
**ะะะ ะฃะกะขะะะะะะ protoc** - ัะฐะนะปั ัะพะทะดะฐะฝั ะฒัััะฝัั ะฝะฐ ะพัะฝะพะฒะต proto ะพะฟัะตะดะตะปะตะฝะธะน:

```
src/grpc/
โโโ api_core_pb.js              (AlgorithmRequest)
โโโ api_core_grpc_web_pb.js     (FrontendStreamServiceClient)
โโโ shared_common_pb.js         (GraphPartResponse, ParseStatus, ะธ ะฒัะต ะฒะปะพะถะตะฝะฝัะต ัะธะฟั)
```

### 4. โ ะกะพะทะดะฐะฝ ะฝะพะฒัะน grpcClient
**ะะพะฒะฐั ัะตะฐะปะธะทะฐัะธั** ะธัะฟะพะปัะทัะตั ัะณะตะฝะตัะธัะพะฒะฐะฝะฝัะต proto ะบะปะฐััั:
- `src/services/grpcClient.js` - ะะะะะฏ ะฒะตััะธั (ะฐะบัะธะฒะฝะฐั)
- `src/services/grpcClient-old.js` - ัะตะทะตัะฒะฝะฐั ะบะพะฟะธั ััะฐัะพะน ะฒะตััะธะธ (750 ัััะพะบ)

### 5. โ ะกะพััะฐะฝะตะฝะฐ ะพะฑัะฐัะฝะฐั ัะพะฒะผะตััะธะผะพััั
ะะฝัะตััะตะนั `connectToStream()` ะพััะฐะปัั ัะตะผ ะถะต:
```javascript
await grpcClient.connectToStream(userId, taskId, {
  onStart: () => {},
  onRequirements: (data) => {},
  onEndpoints: (data) => {},
  onArchitecture: (data) => {},
  onDone: () => {},
  onError: (error) => {}
});
```

## ะัะตะธะผััะตััะฒะฐ ะฝะพะฒะพะน ัะตะฐะปะธะทะฐัะธะธ:

### โ ะฃะผะตะฝััะตะฝะธะต ะบะพะดะฐ
- **ะัะปะพ:** ~750 ัััะพะบ ัััะฝะพะณะพ ะบะพะดะธัะพะฒะฐะฝะธั Protobuf
- **ะกัะฐะปะพ:** ~250 ัััะพะบ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะฑะธะฑะปะธะพัะตะบ

### โ ะะฐะดัะถะฝะพััั
- ะะฒัะพะผะฐัะธัะตัะบะฐั ัะตัะธะฐะปะธะทะฐัะธั/ะดะตัะตัะธะฐะปะธะทะฐัะธั
- ะะพะดะดะตัะถะบะฐ ะฒัะตั ัะธะฟะพะฒ Protobuf ะธะท ะบะพัะพะฑะบะธ
- ะะตะฝััะต ะพัะธะฑะพะบ ะฟัะธ ะธะทะผะตะฝะตะฝะธะธ proto ัะฐะนะปะพะฒ

### โ ะะพะดะดะตัะถะธะฒะฐะตะผะพััั
- ะัะธ ะธะทะผะตะฝะตะฝะธะธ proto ัะฐะนะปะพะฒ ะฝะต ะฝัะถะฝะพ ะผะตะฝััั ะบะพะด ะฒัััะฝัั
- ะะตะณัะต ะดะพะฑะฐะฒะปััั ะฝะพะฒัะต ะฟะพะปั ะธ ะผะตัะพะดั

## ะะฐะบ ัะฐะฑะพัะฐะตั ะฝะพะฒัะน ะบะปะธะตะฝั:

```javascript
import { SimpleFrontendStreamServiceClient } from '../grpc/api_core_grpc_web_pb';
import { AlgorithmRequest } from '../grpc/api_core_pb';
import { ParseStatus } from '../grpc/shared_common_pb';

// ะกะพะทะดะฐัะผ ะบะปะธะตะฝั
const client = new SimpleFrontendStreamServiceClient(envoyUrl);

// ะกะพะทะดะฐัะผ ะทะฐะฟัะพั
const request = new AlgorithmRequest();
request.setUserId(userId);
request.setTaskId(taskId);

// ะะฐะฟััะบะฐะตะผ stream
const stream = client.runAlgorithm(request, {});

// ะะฑัะฐะฑะฐััะฒะฐะตะผ ัะพะฑััะธั
stream.on('data', (message) => {
  const status = message.getStatus();
  const requirements = message.getGraphRequirements();
  // ...
});

stream.on('error', (error) => {
  console.error('Stream error:', error);
});

stream.on('end', () => {
  console.log('Stream completed');
});
```

## ะขะตััะธัะพะฒะฐะฝะธะต:

ะะฐะฟัััะธัะต dev ัะตัะฒะตั ะธ ะฟัะพะฒะตัััะต:
```bash
npm run dev
```

ะัะบัะพะนัะต ัััะฐะฝะธัั ะฐะฝะฐะปะธะทะฐ ะฟัะพะตะบัะฐ ะธ ะฟัะพะฒะตัััะต:
1. โ Stream ะฟะพะดะบะปััะฐะตััั
2. โ ะกะพะพะฑัะตะฝะธั ะฟัะธัะพะดัั ะบะพััะตะบัะฝะพ
3. โ ะกัะฐััั DONE ะฟะพะปััะตะฝ
4. โ ะะตั ะพัะธะฑะพะบ ะฒ ะบะพะฝัะพะปะธ

## ะัะบะฐั (ะตัะปะธ ะฝัะถะฝะพ):

ะัะปะธ ะฒะพะทะฝะธะบะฝัั ะฟัะพะฑะปะตะผั, ะผะพะถะฝะพ ะฒะตัะฝััััั ะบ ััะฐัะพะน ะฒะตััะธะธ:
```powershell
Copy-Item "src\services\grpcClient-old.js" "src\services\grpcClient.js" -Force
```

## ะคะฐะนะปะพะฒะฐั ััััะบัััะฐ ะฟะพัะปะต ะผะธะณัะฐัะธะธ:

```
frontend/
โโโ backend-proto/           โ Proto ัะฐะนะปั ะธะท ะฑัะบะตะฝะดะฐ
โ   โโโ proto/
โ       โโโ api/core.proto
โ       โโโ shared/common.proto
โโโ src/
โ   โโโ grpc/               โ ะกะณะตะฝะตัะธัะพะฒะฐะฝะฝัะต JavaScript ัะฐะนะปั
โ   โ   โโโ api_core_pb.js
โ   โ   โโโ api_core_grpc_web_pb.js
โ   โ   โโโ shared_common_pb.js
โ   โโโ services/
โ       โโโ grpcClient.js         โ ะะะะะฏ ัะตะฐะปะธะทะฐัะธั (ะฐะบัะธะฒะฝะฐั)
โ       โโโ grpcClient-old.js     โ ะะตะทะตัะฒะฝะฐั ะบะพะฟะธั ััะฐัะพะน (750 ัััะพะบ)
โ       โโโ grpcClient-grpc-web.js โ ะะปััะตัะฝะฐัะธะฒะฝะฐั ะฒะตััะธั ะธะท ะณะฐะนะดะฐ
โโโ package.json            โ google-protobuf ะธ grpc-web ัััะฐะฝะพะฒะปะตะฝั
```

## ะฃะดะฐะปัะฝะฝัะต ัะฐะนะปั:

โ `protobuf-33.2/` - ะธััะพะดะฝะธะบะธ protobuf (ะฝะต ะฝัะถะฝั)  
โ `backend-main/` - ะบะพะฟะธั ะฑัะบะตะฝะดะฐ (proto ัะฐะนะปั ัะถะต ัะบะพะฟะธัะพะฒะฐะฝั)

## ะกะปะตะดัััะธะต ัะฐะณะธ:

1. ะัะพัะตััะธััะนัะต ะฝะพะฒัั ัะตะฐะปะธะทะฐัะธั
2. ะัะปะธ ะฒัั ัะฐะฑะพัะฐะตั - ัะดะฐะปะธัะต `grpcClient-old.js` ะธ `grpcClient-new.js`
3. ะะฐัะปะฐะถะดะฐะนัะตัั ัะธัััะผ ะบะพะดะพะผ! ๐
